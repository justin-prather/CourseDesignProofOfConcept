function tick(a){update&&(update=!1,updateList(),stage.update(a))}var update=!1,canvas,stage,scale,railLength,template,activeRail,rails=[],dblClick=!1,setRingParams=function(){var a=$("#widthInput").val(),b=$("#heightInput").val();railLength=$("#railLength").val();var c=b/a,d=$(".container").width();canvas.width=d,scale=d/a,console.log(railLength*scale),canvas.height=d*c,update=!0};$(function(){template=Handlebars.compile($("#rails-template").html()),$("#submit").click(setRingParams),canvas=document.getElementById("demoCanvas"),canvas.addEventListener("mousewheel",MouseWheelHandler,!1),setRingParams(),stage=new createjs.Stage(canvas),stage.addEventListener("stagemousedown",function(a){dblClick?(rails.push(newRail("Red",a.stageX,a.stageY)),update=!0):(dblClick=!0,setTimeout(function(){dblClick=!1},200),activeRail=null)}),$("#rails").on("click",".delete",function(){var a=event.target,b=$(a).parent().attr("id");stage.removeChild(rails[b]),rails.splice(b,1),update=!0}),stage.update(),createjs.Ticker.addEventListener("tick",tick)});var newRail=function(a,b,c){var d=new createjs.Shape;return d.graphics.beginFill(a).drawRect(0,0,railLength*scale,2*scale),d.regX=railLength*scale/2,d.regY=scale,d.x=b,d.y=c,d.rotation=90,d.on("mousedown",function(a){this.offset={x:this.x-a.stageX,y:this.y-a.stageY}}),d.on("click",function(a){console.log("hello"),activeRail=this}),d.on("pressmove",function(a){this.x=a.stageX+this.offset.x,this.y=a.stageY+this.offset.y,update=!0}),stage.addChild(d),d},updateList=function(){var a={};$("#rails").empty();for(var b=0;b<rails.length;b++)a.index=b,a.x=rails[b].x,a.y=rails[b].y,a.angle=rails[b].rotation,$("#rails").append(template(a))},MouseWheelHandler=function(a){var b=Math.max(-1,Math.min(1,a.wheelDelta||-a.detail));if(null!=activeRail&&void 0!=activeRail){var c=activeRail.rotation;c+=5*b,c>360?activeRail.rotation=c-360:0>c?activeRail.rotation=c+360:activeRail.rotation=c,update=!0}return a.preventDefault(),!1};