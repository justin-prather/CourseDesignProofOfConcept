function tick(a){update&&(update=!1,stage.update(a))}var update=!1,canvas,stage,scale,railLength,activeRail,rails=[],dblClick=!1,setRingParams=function(){var a=$("#widthInput").val(),b=$("#heightInput").val();railLength=$("#railLength").val();var c=b/a,d=$(".container").width();canvas.width=d,scale=d/a,console.log(railLength*scale),canvas.height=d*c,update=!0};$(function(){$("#submit").click(setRingParams),canvas=document.getElementById("demoCanvas"),canvas.addEventListener("mousewheel",MouseWheelHandler,!1),setRingParams(),console.log(canvas),stage=new createjs.Stage(canvas),stage.addEventListener("stagemousedown",function(a){dblClick?(rails.push(newRail("Red",a.stageX,a.stageY)),update=!0):(dblClick=!0,setTimeout(function(){dblClick=!1},200))}),stage.update(),createjs.Ticker.addEventListener("tick",tick)});var newRail=function(a,b,c){var d=new createjs.Shape;return d.graphics.beginFill(a).drawRect(0,0,railLength*scale,2*scale),d.regX=railLength*scale/2,d.regY=scale,d.x=b,d.y=c,d.rotation=90,d.on("mousedown",function(a){this.offset={x:this.x-a.stageX,y:this.y-a.stageY},activeRail=this}),d.on("mouseup",function(a){activeRail=null}),d.on("pressmove",function(a){this.x=a.stageX+this.offset.x,this.y=a.stageY+this.offset.y,update=!0}),stage.addChild(d),d},MouseWheelHandler=function(a){var b=Math.max(-1,Math.min(1,a.wheelDelta||-a.detail));return null!=activeRail&&void 0!=activeRail&&(activeRail.rotation+=5*b),a.preventDefault(),!1};